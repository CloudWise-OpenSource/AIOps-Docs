# 基于频域分析的异常检测

### 简介

对每个时间点的数据计算特征，建立每个点的向量。基于每个点的特征向量构建的数据集，做聚类。计算被检测点的特征与正常点的区别来判断正常点与异常点。

### 算法描述

![WechatIMG36](/images/uzDJox4H5rnmsSAqjUtvcQ.png)

图1:频域分析流程图

频域分析算法主要分为4各模块：数据预处理模块、正常点特征模式提取模块、异常检测模块、异常识别模块。

数据预处理主要是对输入数据做预处理。

正常点特征模式提取模块主要是为了定义出正常点集的模式特征。时序数据异常检测通过情况下多为无监督异常检测场景，即历史数据没有被标注为正常点还是异常点。其异常检测的一个标准思路为：寻找数据中的正常点的模式、特征，对比数据模式与正常模式的差异，根据差异程度进行异常与否的判断。

异常检测模式将每个点的模式与正常点模式进行对比，标注数据是否异常。

周期异常识别模块用于检测异常是否为周期性出现的异常。在有些情况下，客户会需求：当一个异常点为周期性出现的异常时，要求算法不将其判别为异常。

算法流程如图一所示。

## **算法功能** 

功能一：基于历史数据，对历史数据或未来一段时间内数据进行异常检测。

当各时间段时序数据模式表现近似，异常数据模式区别于正常时序数据模式时，适合常用频域分析算法进行异常检测。

## **使用操作** 

### 输出说明

- 检测返回的结果是数据json字符串，在输入数据列上增加了新的一列‘anomaly’，0代表正常，1代表异常

- 原小波批量检测返回的结果是数据json字符串，在输入数据列上增加了新的一列‘anomaly’，0代表正常，1代表异常

- 实时频率检测：训练阶段train的过程中如果save设置'0',则不返回结果，只是模型存储；如果save设置'1'，则返回模型字节

- 实时检测predict的过程返回的是跟以前一样是数据json字符串，其中anomaly表示异常情况，0为正常，1为异常

其中检测阶段传输的数据，由于前十五个点无法提取到特征，返回结果中以要检测的点的anomaly数值为准

## **结果展示** 

![](/images/f45o9UNaLAejzQx8Qu7KLr.png)

![](/images/49kfrPfMbcMeTA1B4gvuFN.png)

时间序列异常一般可分为数据异常和模式异常。数值异常表现为数值过大或过小；模式异常表现为数据模式区别于正常时间模式，一般可将模式简单理解为数据点附近时序的形状。

频域分析算法倾向于寻找模式异常点。

|
| laplace_decline = 0 | laplace_decline = 2 |

